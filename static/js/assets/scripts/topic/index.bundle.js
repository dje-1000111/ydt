(()=>{var e={418:()=>{const e=document.getElementById("blur");if(document.getElementById("blur-btn"))var t=document.getElementById("blur-btn");blurStatus=0,t&&(t.onclick=function(){0===blurStatus?(t.innerHTML="Unblur video",e.classList.add("blur-vid"),blurStatus=1):(t.innerHTML="Blur video",e.classList.remove("blur-vid"),blurStatus=0)})},490:()=>{var e=document.getElementById("imgb64");if(document.getElementById("imgb64")){var t=function(e){var t,n,i,a={r:12.9,g:58.8,b:95.3},l=document.createElement("canvas"),o=l.getContext&&l.getContext("2d"),d=-4,r={r:0,g:0,b:0},c=0;if(!o)return a;n=l.height=e.naturalHeight||e.offsetHeight||e.height,t=l.width=e.naturalWidth||e.offsetWidth||e.width,o.drawImage(e,0,0);try{imageData=o.getImageData(0,0,t,n)}catch(e){return console.warn("Image not compatible"),a}for(i=imageData.data.length;(d+=20)<i;)++c,r.r+=imageData.data[d],r.g+=imageData.data[d+1],r.b+=imageData.data[d+2];return r.r=~~(r.r/c),r.g=~~(r.g/c),r.b=~~(r.b/c),r}(e);document.body.style.backgroundColor=`rgb(${t.r}, ${t.g}, ${t.b})`}},851:()=>{let e=document.getElementById("subh");if(document.querySelector("main"))var t=document.querySelector("main");document.addEventListener("dblclick",(function(){if(window.getSelection)var n=window.getSelection().toString();fetch(prde,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8","X-CSRFToken":csrftoken},body:JSON.stringify(n)}).then((async i=>{if(!i.ok){const e=await i.text();throw new Error(e)}{document.getElementById("tt")&&document.getElementById("tt").remove(),document.getElementById("define")&&document.getElementById("define").remove();let d=document.createElement("div"),r=document.createElement("div");r.id="define",r.className="def-container";let c=document.createElement("span");c.className="cross";let s=document.createElement("div");s.className="deft",divTitleContent=document.createTextNode(`${n.charAt(0).toUpperCase()+n.slice(1)}`),s.appendChild(divTitleContent),s.prepend(c),d.className="winbox";let u=document.createElement("ul");var a=JSON.parse(i.headers.get("definition"));for(let e=0;e<Object.keys(a).length;e++){var l=document.createElement("li");let t=document.createTextNode(`${a[e]}`);l.appendChild(t),u.appendChild(l)}Object.keys(a).length>0&&(d.prepend(u),r.prepend(d),r.prepend(s),(e||t).prepend(r));var o=document.getElementById("define");c.addEventListener("click",(function(){o.remove();let e=document.createElement("div");e.id="tt",e.className="tooltipz",divttContent=document.createTextNode("Get word definition"),e.appendChild(divttContent);let n=document.createElement("span");n.className="bg-info p-2 float-end mb-3 tooltiptext",spanttContent=document.createTextNode("Double click on a word to get its definition"),n.appendChild(spanttContent),e.prepend(n),t.prepend(e)}))}}))}))},148:()=>{document.querySelectorAll("input[type=radio][name=rate]").forEach((function(e){e.addEventListener("change",(function(t){t.preventDefault(),1==e.checked&&async function(e,t,n){try{const i=await fetch(e,{method:"POST",body:JSON.stringify(t),dataType:"json",headers:n});return await i.json()}catch(e){return console.warn(e)}}(aprr,{star_rating:t.target.value,dictation_id:t.target.id},{Accept:"application/json","Content-Type":"application/json","X-CSRFToken":csrftoken})}))}))}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var l=t[i]={exports:{}};return e[i](l,l.exports,n),l.exports}(()=>{"use strict";n(851),n(418),n(490);var e=[],t=[];var i=document.getElementById("story-segment");function a(n){n=n.slice(0,-1);let a=document.createElement("li"),l=document.createElement("i");l.className="fa-solid fa-copy style='color: #a8bb24;'",window[`textline${counter}`]=document.createTextNode(n),a.appendChild(window[`textline${counter}`]),i.appendChild(a),t.push(n),window[`btn${lineNb}`]=document.createElement("button"),window[`btn${lineNb}`].className="btn",window[`btn${lineNb}`].id=`copy-${lineNb}`,window[`btn${lineNb}`].appendChild(l),a.appendChild(window[`btn${lineNb}`]),e.push(window[`btn${lineNb}`]),e.forEach((n=>{n.addEventListener("click",(function(i){!async function(e){try{await navigator.clipboard.writeText(e)}catch(e){return console.warn("Failed to copy: ",e)}}(t[e.indexOf(n)])}))}))}async function l(e,t,n){try{const i=await fetch(e,{method:"POST",body:JSON.stringify(t),headers:n});return await i.json()}catch(e){return console.warn(e)}}const o={Accept:"application/json","Content-Type":"application/json","X-CSRFToken":csrftoken};if(document.getElementById("id_textarea"))var d=document.getElementById("id_textarea").value;var r=document.getElementById("counter"),c=document.getElementById("check"),s=document.getElementById("reveal"),u=document.getElementById("result_correction"),m=0,p=!1,b=!1;const v=document.getElementById("tip");var y,g,f,h;function N(){!0===b&&(b=!1),s.innerHTML=`Reveal 1st letter <i class="fa-solid fa-${h}"></i>`;let e=document.getElementById("next");g&&!0===p?(u.innerHTML=f,u.classList.add("text-valid"),u.classList.remove("text-invalid"),!e&&lineNb<ts.length-2?(function(){(y=document.createElement("button")).className="btn btn-success float-end mt-3",y.id="next";let e=document.createTextNode("Next");y.appendChild(e),document.querySelector("#complete").appendChild(y)}(),y.onclick=function(){lineNb<ts.length-2&&!0===p&&(lineNb+=1,m=ts[lineNb],player.seekTo(m,!0),player.playVideo(),done=!1,document.getElementById("id_textarea").value="",p=!1,u.innerHTML="",h=0,s.innerHTML=`Reveal 1st letter <i class="fa-solid fa-${h}"></i>`,r.innerHTML=lineNb,lines.push(lineNb-1),v.innerHTML=void 0!==tip[lineNb]?`<i class="fa-solid fa-lightbulb"></i> TIP: ${tip[lineNb]}`:v.innerHTML="",a(f),l(aptc,{lineNb,new_text:d,topicname,reveal_status:b,new_page:!0,dictation_id},o)),y.remove()}):lineNb==ts.length-2&&!0===p&&(lines.push(lineNb-1),console.log("congrats",lines,totl),u.innerHTML="This is the end, nice work, congrats! :)",a(f))):(u.classList.add("text-invalid"),u.classList.remove("text-valid"),u.innerHTML=g)}(c||s)&&[c,s].forEach((e=>{e.addEventListener("click",(function(t){var n=document.getElementById("id_textarea").value;b=e===s,l(aptc,{lineNb,new_text:n,topicname,reveal_status:b,new_page:!1,dictation_id},o).then((e=>{g=e.result,p=e.state,f=e.original,h=e.reveal_attempts,N()}))}))})),document.addEventListener("keydown",(e=>{if(e.ctrlKey&&(player&&player.seekTo(ts[lineNb],!0),window.clearTimeout(timeout),player.seekTo(ts[lineNb],!0),player.playVideo(),done=!1),"Enter"===e.key){e.preventDefault();let t=document.getElementById("id_textarea").value;l(aptc,{lineNb,new_text:t,topicname,reveal_status:b,new_page:!1,dictation_id},o).then((e=>{g=e.result,p=e.state,f=e.original,h=e.reveal_attempts,N()}))}})),n(148);const E=document.getElementById("previous"),T=document.getElementById("go-next"),w=document.getElementById("replay"),L='<i class="fa-solid fa-lightbulb" style="color: #ffffff;"></i>';v.innerHTML=void 0!==tip[lineNb]?`${L} TIP: ${tip[lineNb]}`:v.innerHTML="",document.getElementById("replay")&&w.addEventListener("click",(function(e){paused?(player.seekTo(ts[lineNb],!0),window.clearTimeout(timeout),player.playVideo(),done=!1,paused=!1):(player.pauseVideo(),paused=!0,w.innerHTML="Play")})),document.getElementById("previous")&&E.addEventListener("click",(function(e){lineNb>=1&&(lineNb-=1),v.innerHTML=void 0!==tip[lineNb]?`${L}  TIP: ${tip[lineNb]}`:v.innerHTML="",player.seekTo(ts[lineNb],!0),counter.innerHTML=lineNb,lines.includes(lineNb)?create_level_valid():del_level_valid(),window.clearTimeout(timeout),player.seekTo(ts[lineNb],!0),player.playVideo(),done=!1,reveal.innerHTML=`Reveal 1st letter <i class="fa-solid fa-${revealAttempts}"></i>`})),document.getElementById("go-next")&&T.addEventListener("click",(function(e){lineNb<totl&&(lineNb+=1),v.innerHTML=void 0!==tip[lineNb]?`${L}  TIP: ${tip[lineNb]}`:v.innerHTML="",player.seekTo(ts[lineNb],!0),counter.innerHTML=lineNb,lines.includes(lineNb)?create_level_valid():del_level_valid(),window.clearTimeout(timeout),player.seekTo(ts[lineNb],!0),player.playVideo(),done=!1,reveal.innerHTML=`Reveal 1st letter <i class="fa-solid fa-${revealAttempts}"></i>`})),document.getElementById("previous")&&previous.addEventListener("click",(function(){lineNb>0&&i.lastElementChild&&i.removeChild(i.lastElementChild)}))})()})();